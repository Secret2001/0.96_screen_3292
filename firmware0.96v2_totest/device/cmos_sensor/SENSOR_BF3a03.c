#include "cmos_sensor.h"


#if DEV_SENSOR_BF3A03 > 0

SENSOR_INIT_SECTION const unsigned char BF3A03InitTable[]=
{
	0x12,0x80,
	0x09,0x78,//0x7d,//55
	0x15,0x32,
	0x1e,0x40,		// 0x40 is 0' , 0x70 is 180'
	0x06,0x78,
	0x21,0x00,//0x00
	0x3e,0x37,
	0x29,0x2b,
	0x27,0x98,
	0x16,0x2f,//0x25
	0x20,0x64,//0x00
	0xd2,0x18,
	0x11,0x1c,//0x10
	0x2f,0x4e,//0x4e
	0x1b,0x09,
	0x3a,0x00,
	0x4a,0x98,//0x98 //VB相关
	0x12,0x00,
	0x13,0x08,
	0x01,0x14,
	0x02,0x20,
	0x8c,0x02,
	0x8d,0x4c,
	0x87,0x16,
	0x13,0x07,
	0x35,0x46,
	0x65,0x38,
	0x66,0x42,
	0x70,0x0f,
	0x3b,0x00,
	0x71,0x0c,
	0x73,0x27,
	0x75,0x88,
	0x76,0xd8,
	0x77,0x0a,
	0x78,0xff,
	0x79,0x14,
	0x7a,0x24,
	0x9e,0x04,
	0x7d,0x2a,
	0x39,0xa0,
	0x3f,0xa0,
	0x90,0x20,
	0x5f,0x04,//0x00
	0x40,0x22,
	0x41,0x23,
	0x42,0x28,
	0x43,0x25,
	0x44,0x1d,
	0x45,0x17,
	0x46,0x13,
	0x47,0x12,
	0x48,0x10,
	0x49,0x0d,
	0x4b,0x0b,
	0x4c,0x0b,
	0x4e,0x09,
	0x4f,0x07,
	0x50,0x06,
	0x13,0x07,
	0x24,0x60, //50xz
	0x97,0x40,
	0x25,0x88,
	0x81,0xff, //00
	0x82,0x18,
	0x83,0x30,
	0x84,0x20,
	0x85,0x38,
	0x86,0x90, //88 xz
	0x94,0x62, //42 xz //82
	0x80,0x92,
	0x98,0x8a,
	0x89,0x2d,
	0x8a,0x73,//0x75,//93
	0x8b,0x60,//0x62,//7a
	0x8e,0x2c,
	0x8f,0x82,
	//0x2a,0x00,	//HBH
	//0x2b,0x00,//0x20//HBL hb = 0x100
	//0x92,0x09,//DM_LNL
	//0x93,0x00,//DM_LNH
	//0xe3,0x09,
	//0xe4,0x00,
	0x5a,0xec,
	0x51,0x90,
	0x52,0x10,
	0x53,0x8d,
	0x54,0x88,
	0x57,0x82,
	0x58,0x8d,
	0x5a,0x7c,
	0x51,0x80,
	0x52,0x04,
	0x53,0x8d,
	0x54,0x88,
	0x57,0x82,
	0x58,0x8d,
	0x5a,0x6c,
	0x51,0x93,
	0x52,0x04,
	0x53,0x8a,
	0x54,0x88,
	0x57,0x02,
	0x58,0x8d,
	0xb0,0xa0,
	0xb1,0x26,
	0xb2,0x1c,
	0xb4,0xfd,
	0xb0,0x30,
	0xb1,0xd8,
	0xb2,0xb0,
	0xb4,0xf1,
	0x3c,0x40,
	0x56,0x48,
	0x4d,0x40,
	0x59,0x40,
	0xb4,0xf1,//e1
	0x56,0x40,
	0x6a,0xd1,//81
	0x23,0x11,//33
	0xa2,0x0b,
	0xa3,0x26,
	0xa4,0x08,
	0xa5,0x26,
	0xa7,0x1a,
	0xa8,0x14,
	0xa9,0x14,
	0xaa,0x14,
	0xab,0x16,
	0xac,0x44,
	0xad,0xf0,
	0xae,0x57,
	0xc5,0x66,
	0xc7,0x38,
	0xc8,0x0d,
	0xc9,0x16,
	0xd3,0x09,
	0xd4,0x15,
	0xd0,0x00,
	0x35,0x38,
	0x65,0x38,
	0x66,0x38,
	0x96,0xf5,
	0x9f,0xf4,
	0xd1,0x00,
-1,-1};

static void BF3A03_rotate(u32 r)
{
	unsigned char buf[2];
	buf[0] = 0x1e;
	buf[1] = 0x40|(r<<4);
	//	sensor_iic_enable();
	//	sensor_iic_info();
		
	sensor_iic_write(buf);
		
	//	sensor_iic_disable();

}

static void BF3A03_hvblank(u32 h,u32 v)
{
	u32 i;
	const u8 t[][2] = {
		{0x2a,(h >> 8) << 4 },
		{0x2b,h & 0xff},
		{0x92,v & 0xff},
		{0x93,v >> 8},
		{0xe3,0x09},
		{0xe4,0},
	};
	
	for(i=0;i<6;i++)
		sensor_iic_write((u8 *)&t[i][0]);
	//	sensor_iic_disable();
}

SENSOR_OP_SECTION const Sensor_Op_t bf3a03_cmd=
{
	.typ = CSI_TYPE_YUV422,
	.pixelw = 640,
	.pixelh= 480,
	.hsyn = 1,
	.vsyn = 1,
	.rduline = 0,//
	.colrarray = 2,//0:_RGRG_ 1:_GRGR_,2:_BGBG_,3:_GBGB_
	.rotate_adapt = {0},
	.hvb_adapt = {0x100,0x09,0x100,0x09},
	. mclk = 16000000,
	.p_fun_adapt = {BF3A03_rotate,BF3A03_hvblank,NULL},
};

SENSOR_HEADER_ITEM_SECTION const Sensor_Init_t bf3a03_init=
{
	.sensor_struct_addr =	(u32 *)&bf3a03_cmd,      
	.sensor_struct_size = sizeof(Sensor_Op_t),
	.sensor_init_tab_adr =	(u32 *)BF3A03InitTable,     
	.sensor_init_tab_size = sizeof(BF3A03InitTable),
	.id               =	0x3a,                    
	.w_cmd            =	0xdc,                    
	.r_cmd            =	0xdd,                    
	.addr_num         =	0x01,                    
	.data_num         =	0x01,                    
	.id_reg           =	0xfc,//bf3               
};


#endif

