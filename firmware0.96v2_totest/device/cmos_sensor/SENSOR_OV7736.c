#include "cmos_sensor.h"

#if DEV_SENSOR_OV7736>0



SENSOR_INIT_SECTION const unsigned char OV7736InitTable[]=
{
	0x30,0x08, 0x82,
	0x30,0x08, 0x42,
	0x36,0x30, 0x11,
	0x31,0x04, 0x03,
	0x30,0x17, 0x7f,
	0x30,0x18, 0xfc,
	0x36,0x00, 0x1c,
	0x36,0x02, 0x04,
	0x36,0x11, 0x44,
	0x36,0x12, 0x63,
	0x36,0x31, 0x22,
	0x36,0x22, 0x00,
	0x36,0x33, 0x25,
	0x37,0x0d, 0x07,
	0x37,0x20, 0x42,
	0x37,0x14, 0x19,
	0x37,0x15, 0xfa,
	0x37,0x0b, 0x43,
	0x37,0x13, 0x1a,
	0x40,0x1c, 0x00,
	0x40,0x1e, 0x11,
	0x47,0x02, 0x01,
	0x3a,0x00, 0x7a,
	0x3a,0x18, 0x00,
	0x3a,0x19, 0x3f,
	0x30,0x0f, 0x88,
	0x30,0x11, 0x08,
	0x43,0x03, 0xff,
	0x43,0x07, 0xff,
	0x43,0x0b, 0xff,
	0x43,0x05, 0x00,
	0x43,0x09, 0x00,
	0x43,0x0d, 0x00,
	0x51,0x81, 0x04,
	0x54,0x81, 0x26,
	0x54,0x82, 0x35,
	0x54,0x83, 0x48,
	0x54,0x84, 0x63,
	0x54,0x85, 0x6e,
	0x54,0x86, 0x77,
	0x54,0x87, 0x80,
	0x54,0x88, 0x88,
	0x54,0x89, 0x8f,
	0x54,0x8a, 0x96,
	0x54,0x8b, 0xa3,
	0x54,0x8c, 0xaf,
	0x54,0x8d, 0xc5,
	0x54,0x8e, 0xd7,
	0x54,0x8f, 0xe8,
	0x54,0x90, 0x0f,
	0x40,0x01, 0x02,
	0x40,0x04, 0x06,
	0x38,0x00, 0x00,
	0x38,0x01, 0x8e,
	0x38,0x10, 0x08,
	0x38,0x11, 0x02,
	0x38,0x0c, 0x03,
	0x38,0x0d, 0x20,
	0x38,0x0e, 0x01,
	0x38,0x0f, 0xf4,
	0x3a,0x09, 0x96,
	0x3a,0x0b, 0x7d,
	0x43,0x00, 0x30,
	0x50,0x1f, 0x01,
	0x50,0x00, 0x4f,
	0x50,0x01, 0x47,
	0x37,0x0d, 0x0b,
	0x37,0x15, 0x1a,
	0x37,0x0e, 0x00,
	0x37,0x13, 0x08,
	0x37,0x03, 0x2c,
	0x37,0x20, 0xc2,
	0x37,0x14, 0x36,
	0x37,0x16, 0x01,
	0x36,0x23, 0x03,
	0x3c,0x00, 0x00,
	0x3c,0x01, 0x32,
	0x3c,0x04, 0x12,
	0x3c,0x05, 0x60,
	0x3c,0x06, 0x00,
	0x3c,0x07, 0x20,
	0x3c,0x08, 0x00,
	0x3c,0x09, 0xc2,
	0x30,0x0d, 0x22,
	0x3c,0x0a, 0x9c,
	0x3c,0x0b, 0x40,
	0x30,0x08, 0x02,
	0x51,0x80, 0x02,
	0x51,0x81, 0x02,
	0x3a,0x0f, 0x35,
	0x3a,0x10, 0x2c,
	0x3a,0x1b, 0x36,
	0x3a,0x1e, 0x2d,
	0x3a,0x11, 0x90,
	0x3a,0x1f, 0x10,
	0x50,0x00, 0xcf,
	0x54,0x81, 0x0a,
	0x54,0x82, 0x13,
	0x54,0x83, 0x23,
	0x54,0x84, 0x40,
	0x54,0x85, 0x4d,
	0x54,0x86, 0x58,
	0x54,0x87, 0x64,
	0x54,0x88, 0x6e,
	0x54,0x89, 0x78,
	0x54,0x8a, 0x81,
	0x54,0x8b, 0x92,
	0x54,0x8c, 0xa1,
	0x54,0x8d, 0xbb,
	0x54,0x8e, 0xcf,
	0x54,0x8f, 0xe3,
	0x54,0x90, 0x26,
	0x53,0x80, 0x42,
	0x53,0x81, 0x33,
	0x53,0x82, 0x0f,
	0x53,0x83, 0x0b,
	0x53,0x84, 0x42,
	0x53,0x85, 0x4d,
	0x53,0x92, 0x1e,
	0x58,0x01, 0x00,
	0x58,0x02, 0x00,
	0x58,0x03, 0x00,
	0x58,0x04, 0x12,
	0x58,0x05, 0x15,
	0x58,0x06, 0x08,
	0x50,0x01, 0xc7,
	0x55,0x80, 0x02,
	0x55,0x83, 0x40,
	0x55,0x84, 0x26,
	0x55,0x89, 0x10,
	0x55,0x8a, 0x00,
	0x55,0x8b, 0x3e,
	0x53,0x00, 0x0f,
	0x53,0x01, 0x30,
	0x53,0x02, 0x0d,
	0x53,0x03, 0x02,
	0x53,0x00, 0x0f,
	0x53,0x01, 0x30,
	0x53,0x02, 0x0d,
	0x53,0x03, 0x02,
	0x53,0x04, 0x0e,
	0x53,0x05, 0x30,
	0x53,0x06, 0x06,
	0x53,0x07, 0x40,
	0x56,0x80, 0x00,
	0x56,0x81, 0x50,
	0x56,0x82, 0x00,
	0x56,0x83, 0x3c,
	0x56,0x84, 0x11,
	0x56,0x85, 0xe0,
	0x56,0x86, 0x0d,
	0x56,0x87, 0x68,
	0x56,0x88, 0x03,
	0x30,0x08, 0x02,
	0x38,0x18, 0x80,

	-1,-1,-1,
};

static void OV7736_rotate(u32 r)
{
/*
	unsigned char buf[2];
	buf[0] = 0x14;		//0',180'
	buf[1] = 0x10|(r<<0);
	//	sensor_iic_enable();
	//	sensor_iic_info();
		sensor_iic_write(buf);
	// sensor_iic_disable();
*/

}

static void OV7736_hvblank(u32 h,u32 v)
{
/*
	u32 i;
	const u8 t[][2] = {
		{0x01,h & 0xff},//0x6a//0xde //HB[7:0]
		{0x02,v & 0xff},  //0x0c //VB[7:0]
		{0x0f,((v >> 8)<<4)|(h >> 8)} //{0x0f,0x00}, //VB/HB [11:8]
	};
//	sensor_iic_enable();
//	sensor_iic_info();	
	for(i=0;i<3;i++)
		sensor_iic_write((u8 *)&t[i][0]);
// sensor_iic_disable();
*/
}

SENSOR_OP_SECTION const Sensor_Op_t ov7736_cmd= 
{
	.typ = CSI_TYPE_YUV422,
	.pixelw = 640,
	.pixelh= 480,
	.hsyn = 1,
	.vsyn = 0,
	.rduline = 0,//
	.colrarray = 2,//0:_RGRG_ 1:_GRGR_,2:_BGBG_,3:_GBGB_
	.rotate_adapt = {0},
	.hvb_adapt = {0x6a,0x12,0x6a,0x12},
	.mclk = 24000000,
	.p_fun_adapt = {OV7736_rotate,OV7736_hvblank,NULL},
};

SENSOR_HEADER_ITEM_SECTION const Sensor_Init_t ov7736_init=
{
	.sensor_struct_addr =	(u32 *)&ov7736_cmd,    
	.sensor_struct_size = sizeof(Sensor_Op_t),
	.sensor_init_tab_adr =	(u32 *)OV7736InitTable,     
	.sensor_init_tab_size = sizeof(OV7736InitTable),
	.id               =	0x36,                  
	.w_cmd            =	0x42,//0x78,                  
	.r_cmd            =	0x43,//0x79,                  
	.addr_num         =	0x02,                  
	.data_num         =	0x01,                  
	.id_reg           =	0x300B                   
};


#endif

